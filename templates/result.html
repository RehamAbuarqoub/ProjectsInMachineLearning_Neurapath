<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Skill Gap Analysis Result</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <style>
        body { background: #f8fafd; font-family: 'Inter', 'Segoe UI', Arial, sans-serif; }
        .result-hero {
            width: 100vw;
            background: linear-gradient(90deg, #149dcc 60%, #d6f6fe 100%);
            padding: 2.5rem 0 2.3rem 0;
            margin-left: 50%;
            transform: translateX(-50%);
            text-align: left;
            margin-bottom: 2.5rem;
        }
        .result-hero-inner { max-width: 950px; margin: 0 auto; color: #fff; padding: 0 2vw;}
        .result-hero-title { font-size: 2.5rem; font-weight: 700; margin-bottom: 0.7rem;}
        .result-hero-desc { font-size: 1.17rem; color: #eafffd;}
        .fit-score-circle { display: flex; align-items: center; justify-content: center; margin: 2.5rem 0 1rem 0;}
        .fit-score-val {
            width: 90px; height: 90px; border-radius: 50%;
            background: linear-gradient(135deg, #0cb3fc 60%, #42e3bc 100%);
            color: #fff; font-size: 2rem; font-weight: bold;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            box-shadow: 0 8px 26px #1aadd944;
        }
        .fit-score-label { font-size: 1rem; color: #2091c3; margin-top: 0.5rem; text-align: center; font-weight: 500;}
        .card { border-radius: 1.1rem; box-shadow: 0 4px 24px #cde8ff44; border: none; margin-bottom: 2.1rem;}
        .badge-tag {
            display: inline-block; background: #f0f7ff; color: #1976d2;
            font-weight: 600; border-radius: 1.2rem; padding: 0.42rem 0.98rem;
            font-size: 1.01rem; margin: 0.15rem 0.18rem 0.15rem 0;
        }
        .badge-tag-success { background: #e8f7ed; color: #22b573;}
        .badge-tag-warning { background: #fff7e0; color: #ffac30;}
        .result-section-title { font-size: 1.23rem; font-weight: bold; margin-bottom: 0.5rem; color: #1875a4;}
        .job-card-title { font-size: 1.12rem; font-weight: 600; color: #1976d2;}
        .btn-primary { font-weight: 700; font-size: 1.1rem; border-radius: 1.1rem;}
        .btn-outline-primary { font-weight: 600; border-radius: 1.1rem;}
        .alert-info, .alert-warning { border-radius: 1.2rem; font-size: 1.06rem;}
        .result-btn-row { display: flex; flex-wrap: wrap; gap: 0.9rem; margin-top: 1.7rem;}
        .alert-missing-skills {
            border-left: 6px solid #ffb400;
            background: #fffbe7;
            color: #b88000;
            padding: 1.1rem 1.2rem;
            border-radius: 1.1rem;
            font-size: 1.08rem;
            margin-bottom: 1.6rem;
        }
        @media (max-width: 900px) {
            .result-hero-inner { padding: 0 4vw;}
            .result-hero-title { font-size: 1.6rem;}
        }
        @media (max-width: 600px) {
            .fit-score-val { width: 68px; height: 68px; font-size: 1.14rem;}
            .result-hero-title { font-size: 1.12rem;}
        }
    </style>
</head>
<body>
    <!-- Modern Hero -->
    <section class="result-hero">
        <div class="result-hero-inner">
            <div class="result-hero-title">Skill Gap Analysis Result</div>
            <div class="result-hero-desc">
                Here is your personalized skill gap match. See your fit score and best alternatives.
            </div>
        </div>
    </section>
    <main class="container" style="max-width: 950px;">
        {% if show_selected %}
            <div class="card p-4 mb-4">
                <h4 class="job-card-title mb-2">{{ job_title }} | {{ company }} | {{ job_location }}</h4>
                <p style="color:#3b4352;">{{ job_summary }}</p>
                <div class="row align-items-center">
                    <div class="col-auto">
                        <div class="fit-score-circle">
                            <div class="fit-score-val">
                                {{ fit_score }}%
                                <div class="fit-score-label">Fit Score</div>
                            </div>
                        </div>
                    </div>
                    <div class="col">
                        <div class="result-section-title mb-1 mt-2">Matched Skills ({{ matched_skills|length }})</div>
                        {% if matched_skills %}
                            {% for skill in matched_skills %}
                                <span class="badge-tag badge-tag-success">{{ skill }}</span>
                            {% endfor %}
                        {% else %}
                            <span class="badge-tag">No skills matched.</span>
                        {% endif %}
                        <div class="result-section-title mt-4">Missing Skills ({{ missing_skills|length }})</div>
                        {% if missing_skills %}
                            {% for skill in missing_skills %}
                                <span class="badge-tag badge-tag-warning">{{ skill }}</span>
                            {% endfor %}
                        {% else %}
                            <span class="badge-tag badge-tag-success">No missing skills!</span>
                        {% endif %}
                    </div>
                </div>
            </div>
        {% else %}
            <div class="alert-missing-skills">
                <b>Selected Job:</b> {{ job_title }} | {{ company }} | {{ job_location }}<br>
                <b>Your fit score:</b> {{ fit_score }}%<br>
                <b>Reason:</b> 
                {% if reason_unmatched %}
                    {{ reason_unmatched }}
                {% else %}
                    Your resume does not match enough of the required skills for this job.
                {% endif %}
            </div>
        {% endif %}

        {% if best_jobs %}
        <div class="mt-4">
            <div class="result-section-title mb-3">Other Best Fit Jobs (Fit Score above 50%)</div>
            <div class="row">
                {% for job in best_jobs %}
                <div class="col-md-6">
                    <div class="card p-3 mb-3">
                        <h6 class="job-card-title">{{ job.job_title }} | {{ job.company }} | {{ job.job_location }}</h6>
                        <p style="margin-bottom:7px;"><b>Fit Score:</b> <span class="badge-tag badge-tag-success">{{ (job.fit_score * 100) | round(0) }}%</span></p>
                        <div style="margin-bottom:5px;"><b>Matched:</b>
                            {% if job.matched_skills %}
                                {% for skill in job.matched_skills %}
                                    <span class="badge-tag badge-tag-success">{{ skill }}</span>
                                {% endfor %}
                            {% else %}
                                <span class="badge-tag">None</span>
                            {% endif %}
                        </div>
                        <div style="margin-bottom:5px;"><b>Missing:</b>
                            {% if job.missing_skills %}
                                {% for skill in job.missing_skills %}
                                    <span class="badge-tag badge-tag-warning">{{ skill }}</span>
                                {% endfor %}
                            {% else %}
                                <span class="badge-tag badge-tag-success">None</span>
                            {% endif %}
                        </div>
                        <p class="text-muted" style="font-size:0.98rem;">{{ job.job_summary[:200] }}...</p>
                        {% if job.job_link %}
                            <a href="{{ job.job_link }}" target="_blank" class="btn btn-sm btn-outline-primary mt-2">View Job Posting</a>
                        {% endif %}
                    </div>
                </div>
                {% endfor %}
            </div>
            <div class="alert alert-info text-center">
                <b>Tip:</b> Focus on learning the missing skills above to become a strong fit for your desired job!
            </div>
        </div>
        {% endif %}
        <div class="result-btn-row">
            <a href="{{ url_for('analyze') }}" class="btn btn-primary mt-3">Analyze Another Resume</a>
            <a href="{{ url_for('logout') }}" class="btn btn-link mt-3">Logout</a>
        </div>
    </main>
</body>
</html>
